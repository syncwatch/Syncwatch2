(()=>{"use strict";var e,w={6465:(e,i,u)=>{var o=u(5861),r=u(2445);function d(){return(d=(0,o.Z)(function*(n){return yield r.db.movies.put(n,n.id)})).apply(this,arguments)}function _(){return(_=(0,o.Z)(function*(n){if(n.data.byteLength<2e6){const m=yield r.db.buffers.put(n.data);return yield r.db.movie_fragments.put({data_id:m,movie_id:n.movie_id,start:n.start,end:n.end})}let p=0,f=0,M=n.data.byteLength;for(;M>0;){const m=Math.min(M,2e6),P=yield r.db.buffers.put(n.data.slice(f,f+2e6));p+=(yield r.db.movie_fragments.put({movie_id:n.movie_id,data_id:P,start:n.start+f,end:n.start+f+m})),f+=m,M-=m}return p})).apply(this,arguments)}function h(){return(h=(0,o.Z)(function*(n){return yield r.db.thumbnails.put(n,n.id)})).apply(this,arguments)}function y(){return(y=(0,o.Z)(function*(){return yield r.db.movies.toArray()})).apply(this,arguments)}function c(){return(c=(0,o.Z)(function*(n){return yield r.db.movies.get(n)})).apply(this,arguments)}function b(){return(b=(0,o.Z)(function*(n){for(let a of yield(yield r.db.movie_fragments.where("movie_id").equals(n).sortBy("start")).reverse())yield r.db.buffers.delete(a.data_id),yield r.db.movie_fragments.delete(a.id),yield r.db.movies.update(n,{downloaded_length:a.start});yield r.db.movies.delete(n)})).apply(this,arguments)}function g(){return(g=(0,o.Z)(function*(n){yield r.db.thumbnails.delete(n)})).apply(this,arguments)}const x={putMovie:function s(n){return d.apply(this,arguments)},getMovies:function O(){return y.apply(this,arguments)},getMovie:function F(n){return c.apply(this,arguments)},putMovieFragment:function l(n){return _.apply(this,arguments)},putThumbnail:function v(n){return h.apply(this,arguments)},deleteMovieAndFragments:function T(n){return b.apply(this,arguments)},deleteThumbnail:function L(n){return g.apply(this,arguments)}};addEventListener("message",function(){var n=(0,o.Z)(function*({data:a}){if(!a||void 0===a.counter||void 0===a.event||!x[a.event])return console.log(a),void console.error("message has no counter or event invalid");try{postMessage({counter:a.counter,data:yield x[a.event](a.data)})}catch(p){p instanceof Error?postMessage({counter:a.counter,error:p.message}):postMessage({counter:a.counter,error:"unknown error"})}});return function(a){return n.apply(this,arguments)}}())}},k={};function t(e){var i=k[e];if(void 0!==i)return i.exports;var u=k[e]={exports:{}};return w[e](u,u.exports,t),u.exports}t.m=w,t.x=()=>{var e=t.O(void 0,["default-src_app_shared_worker_db_ts-node_modules_babel_runtime_helpers_esm_asyncToGenerator_js"],()=>t(6465));return t.O(e)},e=[],t.O=(i,u,o,r)=>{if(!u){var d=1/0;for(s=0;s<e.length;s++){for(var[u,o,r]=e[s],l=!0,_=0;_<u.length;_++)(!1&r||d>=r)&&Object.keys(t.O).every(c=>t.O[c](u[_]))?u.splice(_--,1):(l=!1,r<d&&(d=r));if(l){e.splice(s--,1);var v=o();void 0!==v&&(i=v)}}return i}r=r||0;for(var s=e.length;s>0&&e[s-1][2]>r;s--)e[s]=e[s-1];e[s]=[u,o,r]},t.d=(e,i)=>{for(var u in i)t.o(i,u)&&!t.o(e,u)&&Object.defineProperty(e,u,{enumerable:!0,get:i[u]})},t.f={},t.e=e=>Promise.all(Object.keys(t.f).reduce((i,u)=>(t.f[u](e,i),i),[])),t.u=e=>e+".js",t.miniCssF=e=>{},t.o=(e,i)=>Object.prototype.hasOwnProperty.call(e,i),(()=>{var e;t.tt=()=>(void 0===e&&(e={createScriptURL:i=>i},"undefined"!=typeof trustedTypes&&trustedTypes.createPolicy&&(e=trustedTypes.createPolicy("angular#bundler",e))),e)})(),t.tu=e=>t.tt().createScriptURL(e),t.p="",(()=>{var e={src_app_shared_worker_indexeddb_worker_ts:1};t.f.i=(r,s)=>{e[r]||importScripts(t.tu(t.p+t.u(r)))};var u=self.webpackChunksyncwatch_frontend=self.webpackChunksyncwatch_frontend||[],o=u.push.bind(u);u.push=r=>{var[s,d,l]=r;for(var _ in d)t.o(d,_)&&(t.m[_]=d[_]);for(l&&l(t);s.length;)e[s.pop()]=1;o(r)}})(),(()=>{var e=t.x;t.x=()=>t.e("default-src_app_shared_worker_db_ts-node_modules_babel_runtime_helpers_esm_asyncToGenerator_js").then(e)})(),t.x()})();